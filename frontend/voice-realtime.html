<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>X Hospital Voice Assistant - Real-time</title>\n    <style>\n        * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n        }\n        \n        body {\n            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n            min-height: 100vh;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n        }\n        \n        .voice-container {\n            max-width: 800px;\n            width: 90%;\n            background: white;\n            border-radius: 20px;\n            box-shadow: 0 20px 40px rgba(0,0,0,0.2);\n            overflow: hidden;\n        }\n        \n        .header {\n            background: linear-gradient(135deg, #2196F3, #21CBF3);\n            color: white;\n            padding: 30px;\n            text-align: center;\n        }\n        \n        .header h1 {\n            font-size: 2.5em;\n            margin-bottom: 10px;\n        }\n        \n        .header p {\n            font-size: 1.2em;\n            opacity: 0.9;\n        }\n        \n        .voice-interface {\n            padding: 40px;\n            text-align: center;\n        }\n        \n        .phone-input {\n            margin-bottom: 30px;\n        }\n        \n        .phone-input label {\n            display: block;\n            margin-bottom: 10px;\n            font-weight: bold;\n            color: #333;\n        }\n        \n        .phone-input input {\n            width: 300px;\n            padding: 12px 20px;\n            font-size: 16px;\n            border: 2px solid #ddd;\n            border-radius: 10px;\n            text-align: center;\n        }\n        \n        .voice-controls {\n            margin: 30px 0;\n        }\n        \n        .voice-button {\n            width: 120px;\n            height: 120px;\n            border-radius: 50%;\n            border: none;\n            font-size: 48px;\n            cursor: pointer;\n            transition: all 0.3s ease;\n            margin: 0 20px;\n            position: relative;\n            overflow: hidden;\n        }\n        \n        .voice-button.start {\n            background: linear-gradient(135deg, #4CAF50, #45a049);\n            color: white;\n        }\n        \n        .voice-button.stop {\n            background: linear-gradient(135deg, #f44336, #da190b);\n            color: white;\n        }\n        \n        .voice-button:hover {\n            transform: scale(1.1);\n            box-shadow: 0 10px 20px rgba(0,0,0,0.3);\n        }\n        \n        .voice-button:disabled {\n            opacity: 0.6;\n            cursor: not-allowed;\n            transform: none;\n        }\n        \n        .status-display {\n            margin: 30px 0;\n            padding: 20px;\n            background: #f8f9fa;\n            border-radius: 10px;\n            border-left: 5px solid #2196F3;\n        }\n        \n        .status {\n            font-size: 18px;\n            font-weight: bold;\n            margin-bottom: 10px;\n        }\n        \n        .status.listening {\n            color: #4CAF50;\n        }\n        \n        .status.processing {\n            color: #FF9800;\n        }\n        \n        .status.speaking {\n            color: #2196F3;\n        }\n        \n        .status.error {\n            color: #f44336;\n        }\n        \n        .connection-status {\n            font-size: 14px;\n            margin-bottom: 10px;\n        }\n        \n        .connection-status.connected {\n            color: #4CAF50;\n        }\n        \n        .connection-status.error {\n            color: #f44336;\n        }\n        \n        .visualizer {\n            width: 100%;\n            height: 20px;\n            background: #ddd;\n            border-radius: 10px;\n            overflow: hidden;\n            margin: 20px 0;\n        }\n        \n        .visualizer-bar {\n            height: 100%;\n            background: linear-gradient(90deg, #4CAF50, #2196F3);\n            transition: width 0.1s ease;\n            width: 0%;\n        }\n        \n        .conversation-display {\n            max-height: 400px;\n            overflow-y: auto;\n            background: #f8f9fa;\n            border-radius: 10px;\n            padding: 20px;\n            margin: 20px 0;\n            text-align: left;\n            font-family: monospace;\n            line-height: 1.6;\n        }\n        \n        .message {\n            margin-bottom: 15px;\n            padding: 10px;\n            border-radius: 8px;\n        }\n        \n        .message.user {\n            background: #e3f2fd;\n            margin-left: 20px;\n        }\n        \n        .message.ai {\n            background: #f3e5f5;\n            margin-right: 20px;\n        }\n        \n        .instructions {\n            background: #fff3cd;\n            border: 1px solid #ffeaa7;\n            border-radius: 10px;\n            padding: 20px;\n            margin: 20px 0;\n        }\n        \n        .instructions h3 {\n            color: #856404;\n            margin-bottom: 15px;\n        }\n        \n        .instructions ul {\n            color: #856404;\n            text-align: left;\n            margin-left: 20px;\n        }\n        \n        .instructions li {\n            margin-bottom: 8px;\n        }\n        \n        .settings {\n            background: #f8f9fa;\n            border-radius: 10px;\n            padding: 20px;\n            margin: 20px 0;\n            text-align: left;\n        }\n        \n        .settings h3 {\n            margin-bottom: 15px;\n            color: #333;\n        }\n        \n        .setting-item {\n            margin-bottom: 15px;\n        }\n        \n        .setting-item label {\n            display: inline-block;\n            width: 150px;\n            font-weight: bold;\n        }\n        \n        .setting-item input {\n            width: 200px;\n            padding: 5px 10px;\n            border: 1px solid #ddd;\n            border-radius: 5px;\n        }\n    </style>\n</head>\n<body>\n    <div class=\"voice-container\">\n        <div class=\"header\">\n            <h1>üéôÔ∏è Voice Assistant</h1>\n            <p>Real-time Hospital AI - Just like ChatGPT Voice!</p>\n        </div>\n        \n        <div class=\"voice-interface\">\n            <div class=\"phone-input\">\n                <label for=\"phoneNumber\">Your Phone Number:</label>\n                <input type=\"tel\" id=\"phoneNumber\" placeholder=\"+8801234567890\" value=\"+8801742957256\">\n            </div>\n            \n            <div class=\"voice-controls\">\n                <button id=\"startButton\" class=\"voice-button start\">üé§</button>\n                <button id=\"stopButton\" class=\"voice-button stop\" style=\"display: none;\">‚èπÔ∏è</button>\n            </div>\n            \n            <div class=\"status-display\">\n                <div id=\"status\" class=\"status\">Ready to start</div>\n                <div id=\"connectionStatus\" class=\"connection-status\">Not connected</div>\n                \n                <div class=\"visualizer\">\n                    <div id=\"visualizerBar\" class=\"visualizer-bar\"></div>\n                </div>\n            </div>\n            \n            <div class=\"conversation-display\" id=\"conversation\">\n                <div class=\"message ai\">\n                    <strong>AI:</strong> Welcome to X Hospital! I'm your voice assistant. Click the microphone to start our conversation. I'll listen continuously and respond naturally - just like talking to a real person!\n                </div>\n            </div>\n            \n            <div class=\"instructions\">\n                <h3>üó£Ô∏è How it works:</h3>\n                <ul>\n                    <li><strong>Continuous Listening:</strong> Just speak naturally - no need to press buttons</li>\n                    <li><strong>Smart Detection:</strong> I'll automatically detect when you stop speaking</li>\n                    <li><strong>Real-time Response:</strong> I'll process and respond immediately</li>\n                    <li><strong>Natural Conversation:</strong> Talk as you would to a real person</li>\n                    <li><strong>Appointment Booking:</strong> I can help you book appointments with our doctors</li>\n                </ul>\n            </div>\n            \n            <div class=\"settings\">\n                <h3>‚öôÔ∏è Settings:</h3>\n                <div class=\"setting-item\">\n                    <label>Sensitivity:</label>\n                    <input type=\"range\" id=\"vadThreshold\" min=\"0.005\" max=\"0.05\" step=\"0.005\" value=\"0.01\">\n                    <span id=\"vadValue\">0.01</span>\n                </div>\n                <div class=\"setting-item\">\n                    <label>Silence Timeout:</label>\n                    <input type=\"range\" id=\"silenceTimeout\" min=\"500\" max=\"3000\" step=\"100\" value=\"1500\">\n                    <span id=\"silenceValue\">1500ms</span>\n                </div>\n            </div>\n        </div>\n    </div>\n    \n    <script src=\"js/realtime-voice.js\"></script>\n    <script>\n        let voiceAssistant = null;\n        \n        // UI Elements\n        const phoneInput = document.getElementById('phoneNumber');\n        const startButton = document.getElementById('startButton');\n        const stopButton = document.getElementById('stopButton');\n        const statusElement = document.getElementById('status');\n        const connectionElement = document.getElementById('connectionStatus');\n        const visualizerBar = document.getElementById('visualizerBar');\n        const conversation = document.getElementById('conversation');\n        const vadThreshold = document.getElementById('vadThreshold');\n        const silenceTimeout = document.getElementById('silenceTimeout');\n        const vadValue = document.getElementById('vadValue');\n        const silenceValue = document.getElementById('silenceValue');\n        \n        // Initialize voice assistant\n        async function initializeVoiceAssistant() {\n            try {\n                voiceAssistant = new HospitalVoiceAssistant();\n                \n                // Set UI elements\n                voiceAssistant.setUIElements(\n                    statusElement,\n                    null, // We'll handle transcript display ourselves\n                    connectionElement,\n                    visualizerBar\n                );\n                \n                // Override transcript handling\n                const originalHandleMessage = voiceAssistant.handleWebSocketMessage.bind(voiceAssistant);\n                voiceAssistant.handleWebSocketMessage = function(message) {\n                    // Handle transcription display\n                    if (message.type === 'transcription') {\n                        addMessageToConversation(message.text, 'user');\n                    } else if (message.type === 'voice_response') {\n                        addMessageToConversation(message.text || message.response_text, 'ai', message.emotion_context);\n                    }\n                    \n                    // Call original handler\n                    originalHandleMessage(message);\n                };\n                \n                console.log('‚úÖ Voice assistant initialized');\n                \n            } catch (error) {\n                console.error('‚ùå Error initializing voice assistant:', error);\n                statusElement.textContent = 'Initialization failed';\n                statusElement.className = 'status error';\n            }\n        }\n        \n        // Add message to conversation display\n        function addMessageToConversation(text, sender, emotionContext = null) {\n            const messageDiv = document.createElement('div');\n            messageDiv.className = `message ${sender}`;\n            \n            let emotionInfo = '';\n            if (emotionContext) {\n                emotionInfo = ` <small style=\"color: #666;\">[Emotion: ${emotionContext.detected_emotion}]</small>`;\n            }\n            \n            messageDiv.innerHTML = `<strong>${sender === 'user' ? 'You' : 'AI'}:</strong> ${text}${emotionInfo}`;\n            \n            conversation.appendChild(messageDiv);\n            conversation.scrollTop = conversation.scrollHeight;\n        }\n        \n        // Event handlers\n        startButton.addEventListener('click', async () => {\n            const phoneNumber = phoneInput.value.trim();\n            if (!phoneNumber) {\n                alert('Please enter your phone number first');\n                return;\n            }\n            \n            if (!voiceAssistant) {\n                await initializeVoiceAssistant();\n            }\n            \n            await voiceAssistant.startListening(phoneNumber);\n            \n            startButton.style.display = 'none';\n            stopButton.style.display = 'inline-block';\n            phoneInput.disabled = true;\n            \n            addMessageToConversation('Voice assistant started! Speak naturally...', 'ai');\n        });\n        \n        stopButton.addEventListener('click', () => {\n            if (voiceAssistant) {\n                voiceAssistant.stopListening();\n            }\n            \n            startButton.style.display = 'inline-block';\n            stopButton.style.display = 'none';\n            phoneInput.disabled = false;\n            \n            addMessageToConversation('Voice assistant stopped.', 'ai');\n        });\n        \n        // Settings handlers\n        vadThreshold.addEventListener('input', (e) => {\n            const value = parseFloat(e.target.value);\n            vadValue.textContent = value.toFixed(3);\n            if (voiceAssistant) {\n                voiceAssistant.setVADThreshold(value);\n            }\n        });\n        \n        silenceTimeout.addEventListener('input', (e) => {\n            const value = parseInt(e.target.value);\n            silenceValue.textContent = value + 'ms';\n            if (voiceAssistant) {\n                voiceAssistant.setSilenceTimeout(value);\n            }\n        });\n        \n        // Initialize on page load\n        document.addEventListener('DOMContentLoaded', () => {\n            console.log('üöÄ Real-time Voice Assistant loaded');\n        });\n        \n        // Cleanup on page unload\n        window.addEventListener('beforeunload', () => {\n            if (voiceAssistant) {\n                voiceAssistant.destroy();\n            }\n        });\n    </script>\n</body>\n</html>"